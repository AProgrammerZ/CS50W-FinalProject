{% extends "restaurants/layout.html" %}
{% load static %}

{% block css %}
    <link rel="stylesheet" href="{% static 'restaurants/results.css' %}">
{% endblock %}

{% block js %}
    <script src="{% static 'restaurants/index.js' %}"></script>
{% endblock %}

{% block body %}    
    <div class="flex-container">
        <div class="title">Restaurants in {{ city }}</div> 
        
        <div class="sidebar-and-cards-container">
            <div class="filters-bar">Filters</div>

            <div class="sidebar-container">
                <p>Filters</p>
                
                <form action="{% url 'results' city 'yes' 1000 'empty' 0 4 %}" method="post">
                    {% csrf_token %}
                    {{ form }}
                    <input type="submit" value="Search">
                </form>
            </div>
        
            <div class="cards-container">        
                {% for restaurant in restaurants %}
                    <a class="card-link" href="{% url 'restaurant_page' restaurant.name restaurant.place_id %}">
                        <div class="card">
                            <div class="card-img">
                                <!-- https://www.reddit.com/r/django/comments/kjmj6b/string_formatting_in_template/ -->
                                {% with counter=forloop.counter|stringformat:"s" ref=restaurant.photos.0.photo_reference %}
                                <!-- <img src="{% static 'restaurants/Restaurant_Images/Restaurant'|add:counter|add:'.jpg' %}">                             -->
                                <img src="https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference={{ref}}&key={{api_key}}">
                                {% endwith %}
                            </div>
                            
                            <div class="caption">
                                <h3>{{ restaurant.name }}</h3>
                                <p class="caption-wrap"><b>Address: </b>{{ restaurant.formatted_address }}</p>
                                <p><b>Phone Number: </b>{{ restaurant.formatted_phone_number }}</p>
                                {% if restaurant.website %}
                                    <p><b>Website: </b></p>
                                    <a class="caption-wrap caption-website" href="{{ restaurant.website }}">{{ restaurant.website }}</a>
                                {% else %}
                                    <p><b>Website: </b>unavailable</p>
                                {% endif %}
                                {% if not restaurant.opening_hours.open_now %}
                                    <div class="open_status">Not Open Now</div>
                                {% endif %}
                            </div>
                        </div>                        
                    </a>
                    <div class="line"></div>
                {% endfor %}
            </div>
                    <!-- <div class="card empty-card">
                        {% with counter=1|stringformat:"s" %}
                            <img src="{% static 'restaurants/Restaurant_Images/Restaurant'|add:counter|add:'.jpg' %}">
                        {% endwith %}
                        <div class="caption">
                            <h3>Empty</h3>
                            <p>No information about this restaurant</p>
                        </div>
                    </div>
                </a> -->
            <!-- </div> -->
        <!-- </div> -->

        <!-- <footer>                        
            <div>Design inspired by <a href="https://www.yelp.com/">Yelp</a>, 
                <a href="https://www.opentable.com/">OpenTable</a>, 
                and <a href="https://www.grubhub.com/">Grubhub</a>
            </div>                    

            <div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a
                    href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div>
        </footer> -->
    </div>
{% endblock %}