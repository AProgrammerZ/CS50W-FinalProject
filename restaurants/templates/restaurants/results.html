{% extends "restaurants/layout.html" %}
{% load static %}

{% block css %}
    <link rel="stylesheet" href="{% static 'restaurants/results.css' %}">
{% endblock %}

{% block js %}
    <script src="{% static 'restaurants/index.js' %}"></script>
{% endblock %}

{% block body %}    
    <div class="flex-container">
        <div class="title">Restaurants in {{ city }}</div> 
        
        <div class="sidebar-and-cards-container">
            <div class="filters-bar">Filters</div>

            <div class="sidebar-container">
                <p>Filters</p>
                
                <form action="{% url 'results' city 'yes' 1000 'empty' 0 4 %}" method="post">
                    {% csrf_token %}
                    {{ form }}
                    <input type="submit" value="Search">
                </form>
            </div>
        
            <div class="cards-container">        
                {% for restaurant in restaurants %}
                    <a class="card-link" href="{% url 'restaurant_page' restaurant.poi.name '1a2b3c' %}">
                        <div class="card">
                            <div class="card-img">
                                <!-- https://www.reddit.com/r/django/comments/kjmj6b/string_formatting_in_template/ -->
                                <!-- {% with counter=forloop.counter|stringformat:"s" ref=restaurant.photos.0.photo_reference %} -->
                                    <!-- <img src="{% static 'restaurants/Restaurant_Images/Restaurant'|add:counter|add:'.jpg' %}">                             -->
                                    <!-- <img src="https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference={{ref}}&key={{api_key}}"> -->
                                <!-- {% endwith %} -->
                                <img src="https://cdn.pixabay.com/photo/2019/03/25/20/44/lubeck-4081316_960_720.jpg">
                            </div>
                            
                            <div class="caption">
                                <h3>{{ restaurant.poi.name }}</h3>
                                <p class="caption-wrap"><b>Address: </b>{{ restaurant.address.freeformAddress }}</p>
                                <p><b>Phone Number: </b>{{ restaurant.poi.phone }}</p>
                                {% if restaurant.poi.url %}
                                    <p><b>Website: </b></p>
                                        {% if "http" in restaurant.poi.url %}
                                            <a class="caption-wrap caption-website" href="{{ restaurant.poi.url }}">{{ restaurant.poi.url }}</a>
                                        {% elif "http" not in restaurant.poi.url and "www." in restaurant.poi.url %}
                                            <a class="caption-wrap caption-website" href="https://{{ restaurant.poi.url }}">https://{{ restaurant.poi.url }}</a>
                                        {% else %}
                                            <!-- https://stackoverflow.com/questions/8951423/html-links-without-http-protocol -->
                                            <a class="caption-wrap caption-website" href="//www.{{ restaurant.poi.url }}">www.{{ restaurant.poi.url }}</a>
                                        {% endif %}
                                {% else %}
                                    <p><b>Website: </b>unavailable</p>
                                {% endif %}
                                <!-- {% if not restaurant.opening_hours.open_now %}
                                    <div class="open_status">Not Open Now</div>
                                {% endif %} -->
                            </div>
                        </div>                        
                    </a>
                    <div class="line"></div>
                {% endfor %}
            </div>
                    <!-- <div class="card empty-card">
                        {% with counter=1|stringformat:"s" %}
                            <img src="{% static 'restaurants/Restaurant_Images/Restaurant'|add:counter|add:'.jpg' %}">
                        {% endwith %}
                        <div class="caption">
                            <h3>Empty</h3>
                            <p>No information about this restaurant</p>
                        </div>
                    </div>
                </a> -->
            <!-- </div> -->
        <!-- </div> -->        
    </div>
{% endblock %}