{% extends "restaurants/layout.html" %}
{% load static %}

{% block css %}
    <link rel="stylesheet" href="{% static 'restaurants/results.css' %}">
{% endblock %}

{% block js %}
    <script src="{% static 'restaurants/index.js' %}"></script>
{% endblock %}

{% block body %}    
    <div class="flex-container">
        <div class="title">Restaurants in {{ city }}</div> 
        
        <div class="sidebar-and-cards-container">
            <div class="filters-bar">Filters</div>

            <div class="sidebar-container">
                <p>Filters</p>
                
                <form action="{% url 'results' city 'yes' 1000 'empty' 0 4 %}" method="post">
                    {% csrf_token %}
                    {{ form }}
                    <input type="submit">
                </form>
            </div>

            <div class="cards-container">
                {% for result in results %}            
                    <a href="{% url 'restaurant' result.name result.place_id %}">
                        <div class="card">
                            <!-- https://www.reddit.com/r/django/comments/kjmj6b/string_formatting_in_template/ -->
                            {% with counter=forloop.counter|stringformat:"s" %}
                                <img src="{% static 'restaurants/Restaurant_Images/Restaurant'|add:counter|add:'.jpg' %}">                            
                            {% endwith %}
                            <div class="caption">
                                <h3>{{ result.name }}</h3>
                                {% if result.opening_hours.open_now %}
                                    <p>Open now</p>
                                {% else %}
                                    <p>Not open now</p>
                                {% endif %}
                                <p><b>Address: </b>{{ results_details.0.formatted_address }}</p>
                                <p><b>Phone Number: </b>{{ results_details.0.formatted_phone_number }}</p>
                                {% if results_details.1.website %}
                                    <p><b>Website: </b><a href="{{ results_details.1.website }}">{{ results_details.1.website }}</a></p>
                                {% else %}
                                    <p><b>Website: </b>unavailable</p>
                                {% endif %}
                            </div>                      
                        </div>
                        <div class="line"></div>
                    </a>                            
                {% endfor %} 
                <a href="{% url 'restaurant' 'Dunkin Donuts' 'ChIJyWEHuEmuEmsRm9hTkapTCrk' %}">
                    <div class="card empty-card">
                        {% with counter=1|stringformat:"s" %}
                            <img src="{% static 'restaurants/Restaurant_Images/Restaurant'|add:counter|add:'.jpg' %}">
                        {% endwith %}
                        <div class="caption">
                            <h3>Empty</h3>
                            <p>No information about this restaurant</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>

        <footer>                        
            <div>Design inspired by <a href="https://www.yelp.com/">Yelp</a>, 
                <a href="https://www.opentable.com/">OpenTable</a>, 
                and <a href="https://www.grubhub.com/">Grubhub</a>
            </div>                    

            <div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a
                    href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div>
        </footer>
    </div>
{% endblock %}